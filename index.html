<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lotto-Matrix</title>
  <style>
    :root {
      --cell-size: 12vw;
      --selected-color: #d0f0ff;
      --border-color: #0077cc;
    }

    body {
      font-family: system-ui, sans-serif;
      margin: 0;
      padding: 1rem;
      background: #f9f9f9;
      color: #333;
    }

    h1 {
      text-align: center;
      font-size: 1.5rem;
      margin-bottom: 1rem;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(7, var(--cell-size));
      gap: 4px;
      justify-content: center;
      margin-bottom: 1rem;
    }

    .cell {
      background: white;
      border: 1px solid #ccc;
      width: var(--cell-size);
      height: var(--cell-size);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      border-radius: 6px;
      user-select: none;
      touch-action: manipulation;
    }

    .cell:hover {
      background: #eef;
      cursor: pointer;
    }

    .selected {
      background: var(--selected-color);
      border: 2px solid var(--border-color);
    }

    .status {
      font-size: 0.9rem;
      line-height: 1.4;
      margin-bottom: 1rem;
    }

    .controls {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.5rem;
    }

    button, input[type="file"] {
      font-size: 1rem;
      padding: 0.5rem 1rem;
      border: none;
      border-radius: 5px;
      background: #0077cc;
      color: white;
      cursor: pointer;
    }

    button:hover {
      background: #005fa3;
    }

    input[type="file"] {
      background: #555;
    }
  </style>
</head>
<body>

<h1>üéØ Lotto-Matrix</h1>
<div class="grid" id="matrix" aria-label="Lotto Matrix"></div>

<div class="status" id="status">Status wird hier angezeigt...</div>

<div class="controls">
  <button onclick="saveSelection()">üíæ Tipp speichern</button>
  <button onclick="exportSelection()">üì§ Exportieren</button>
  <input type="file" onchange="importSelection(event)" />
</div>

<script>
  const matrix = document.getElementById("matrix");
  const status = document.getElementById("status");
  let selected = [];
  let savedTips = [];

  // Matrix mit Zahlen 1‚Äì49
  for (let i = 1; i <= 49; i++) {
    const cell = document.createElement("div");
    cell.className = "cell";
    cell.textContent = i;
    cell.draggable = true;
    cell.dataset.index = i - 1;
    cell.addEventListener("click", () => toggleSelect(cell));
    cell.addEventListener("dragstart", dragStart);
    cell.addEventListener("dragover", e => e.preventDefault());
    cell.addEventListener("drop", drop);
    matrix.appendChild(cell);
  }

  function toggleSelect(cell) {
    if (selected.includes(cell)) {
      selected = selected.filter(c => c !== cell);
      cell.classList.remove("selected");
    } else if (selected.length < 6) {
      selected.push(cell);
      cell.classList.add("selected");
    }
    updateStatus();
  }

  function updateStatus() {
    const values = selected.map(c => parseInt(c.textContent));
    const even = values.filter(v => v % 2 === 0).length;
    const odd = values.length - even;
    const low = values.filter(v => v <= 25).length;
    const high = values.filter(v => v >= 25).length;
    const edge = selected.filter(c => {
      const i = parseInt(c.dataset.index);
      return i < 7 || i % 7 === 0 || i % 7 === 6 || i >= 42;
    }).length;
    const crossSum = values.reduce((sum, v) => sum + [...v.toString()].reduce((a, b) => a + +b, 0), 0);
    const col46 = selected.filter(c => c.textContent === "46" && c.dataset.index % 7 === 3).length;
    const row22to28 = selected.filter(c => {
      const val = +c.textContent;
      const row = Math.floor(c.dataset.index / 7);
      return val >= 22 && val <= 28 && row === 3;
    }).length;

    status.innerHTML = `
      ‚úÖ Gerade: ${even}, Ungerade: ${odd}<br>
      ‚úÖ 1‚Äì25: ${low}, 25‚Äì49: ${high}<br>
      ‚úÖ Randzahlen: ${edge}<br>
      ‚úÖ Quersumme: ${crossSum} ${crossSum > 153 ? '‚úÖ' : '‚ùå'}<br>
      ‚úÖ Spalte 4 mit 46: ${col46 <= 1 ? '‚úÖ' : '‚ùå'}<br>
      ‚úÖ Zeile mit 22‚Äì28: ${row22to28 <= 1 ? '‚úÖ' : '‚ùå'}<br>
    `;
  }

  function dragStart(e) {
    e.dataTransfer.setData("text/plain", e.target.dataset.index);
  }

  function drop(e) {
    const fromIndex = e.dataTransfer.getData("text/plain");
    const toIndex = e.target.dataset.index;
    const fromCell = matrix.children[fromIndex];
    const toCell = matrix.children[toIndex];
    [fromCell.textContent, toCell.textContent] = [toCell.textContent, fromCell.textContent];
    updateStatus();
  }

  function saveSelection() {
    const tip = selected.map(c => c.textContent);
    savedTips.push(tip);
    alert("Tipp gespeichert: " + tip.join(", "));
  }

  function exportSelection() {
    const blob = new Blob([JSON.stringify(savedTips)], { type: "application/json" });
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "tipps.json";
    a.click();
  }

  function importSelection(event) {
    const file = event.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = () => {
      savedTips = JSON.parse(reader.result);
      alert("Importiert: " + savedTips.map(t => t.join(", ")).join("\n"));
    };
    reader.readAsText(file);
  }
</script>

</body>
</html>
